<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NERD SPACE V5.0 - AI FIRST Edition</title>
    <link rel="stylesheet" href="/static/css/nerdspace.css">
</head>
<body>
    <!-- Sticky Navigation -->
    <nav class="nav-sticky">
        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
            <div style="font-size: 1.25rem; font-weight: 700; color: var(--accent-blue);">
                üöÄ NERD SPACE
            </div>
            <div class="nav-tabs" id="nav-tabs">
                <button class="nav-tab active" data-tab="nerdspace">üöÄ NERD SPACE</button>
                <button class="nav-tab" data-tab="dashboard">üìä Vis√£o Geral</button>
                <button class="nav-tab" data-tab="claude">ü§ñ Claude Max <span class="badge-new">20x</span></button>
                <button class="nav-tab" data-tab="storage">üíæ Storage</button>
                <button class="nav-tab" data-tab="tips">‚å®Ô∏è Mac Tips <span class="badge-new">64</span></button>
            </div>
            <!-- Header Icons -->
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button id="header-speedtest" title="Speed Test" style="background: rgba(255,255,255,0.1); border: none; padding: 0.5rem; border-radius: 0.5rem; cursor: pointer; color: var(--text-secondary); font-size: 1.25rem; transition: all 0.2s;">
                    üì∂ <span id="header-speed-value" style="font-size: 0.75rem; color: var(--accent-green);">--</span>
                </button>
                <button id="header-trash" title="Lixeira" style="background: rgba(255,255,255,0.1); border: none; padding: 0.5rem; border-radius: 0.5rem; cursor: pointer; color: var(--text-secondary); font-size: 1.25rem; transition: all 0.2s;">
                    üóëÔ∏è <span id="header-trash-count" style="font-size: 0.75rem; color: var(--text-muted);">--</span>
                </button>
                <div id="header-clock" style="font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                    --:--
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main style="padding: 1.5rem; max-width: 1400px; margin: 0 auto;">

        <!-- Tab: NERD SPACE Home -->
        <section id="tab-nerdspace" class="tab-content">
            <!-- Hero Section -->
            <div class="card" style="margin-bottom: 1.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(59, 130, 246, 0.2);">
                <div style="text-align: center; padding: 2rem 0;">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">üöÄ</div>
                    <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; background: linear-gradient(90deg, #3b82f6, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">NERD SPACE V5.0</h1>
                    <p style="color: var(--text-secondary); font-size: 1rem; margin-bottom: 1rem;">Seu hub de comando premium para controle total do seu MacBook Pro.</p>
                    <div style="display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                        <span class="badge" style="background: rgba(59, 130, 246, 0.2); color: #60a5fa; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem;">M3 Max</span>
                        <span class="badge" style="background: rgba(139, 92, 246, 0.2); color: #a78bfa; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem;">36GB RAM</span>
                        <span class="badge" style="background: rgba(34, 197, 94, 0.2); color: #4ade80; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem;" id="macos-badge">macOS Tahoe 26.2</span>
                    </div>
                </div>
            </div>

            <!-- Quick Stats Grid -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                <div class="card" style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.25rem;">‚è±Ô∏è</div>
                    <div style="font-size: 1.25rem; font-weight: 700;" id="home-uptime">--</div>
                    <div style="color: var(--text-muted); font-size: 0.75rem;">Uptime</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.25rem;">üíæ</div>
                    <div style="font-size: 1.25rem; font-weight: 700;" id="home-storage">--</div>
                    <div style="color: var(--text-muted); font-size: 0.75rem;">Storage Livre</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.25rem;">üñ•Ô∏è</div>
                    <div style="font-size: 1.25rem; font-weight: 700;" id="home-displays">--</div>
                    <div style="color: var(--text-muted); font-size: 0.75rem;">Displays</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.25rem;">ü§ñ</div>
                    <div style="font-size: 1.25rem; font-weight: 700;" id="home-claude">--</div>
                    <div style="color: var(--text-muted); font-size: 0.75rem;">Claude 5h</div>
                </div>
            </div>

            <!-- AI Insights -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">üß†</span> AI Insights</div>
                    <button id="refresh-insights" style="background: rgba(139, 92, 246, 0.2); color: #a78bfa; border: none; padding: 0.375rem 0.75rem; border-radius: 0.375rem; cursor: pointer; font-size: 0.75rem;">‚Üª Refresh</button>
                </div>
                <div id="ai-insights-container">
                    <div class="skeleton skeleton-block" style="height: 100px;"></div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">‚ö°</span> A√ß√µes R√°pidas</div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 0.75rem;">
                    <button onclick="document.querySelector('[data-tab=dashboard]').click()" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">üìä</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Dashboard</div>
                    </button>
                    <button onclick="document.querySelector('[data-tab=claude]').click()" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">ü§ñ</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Claude Max</div>
                    </button>
                    <button onclick="document.querySelector('[data-tab=storage]').click()" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">üíæ</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Storage</div>
                    </button>
                    <button onclick="document.querySelector('[data-tab=tips]').click()" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">‚å®Ô∏è</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Mac Tips</div>
                    </button>
                    <button id="action-speedtest" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">üì∂</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Speed Test</div>
                    </button>
                    <button id="action-trash" style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); padding: 1rem; border-radius: 0.5rem; cursor: pointer; text-align: center; transition: all 0.2s;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">üóëÔ∏è</div>
                        <div style="color: var(--text-primary); font-size: 0.75rem;">Lixeira</div>
                    </button>
                </div>
            </div>
        </section>

        <!-- Tab: Dashboard -->
        <section id="tab-dashboard" class="tab-content" style="display: none;">
            <!-- System Info Row -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                <!-- macOS Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span style="margin-right: 0.5rem;">üçé</span> macOS</div>
                    </div>
                    <div id="macos-content"><div class="skeleton skeleton-block" style="height: 80px;"></div></div>
                </div>

                <!-- Hardware Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span style="margin-right: 0.5rem;">üíª</span> Hardware</div>
                    </div>
                    <div id="hardware-content"><div class="skeleton skeleton-block" style="height: 80px;"></div></div>
                </div>

                <!-- Uptime Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span style="margin-right: 0.5rem;">‚è±Ô∏è</span> Uptime</div>
                    </div>
                    <div id="uptime-content"><div class="skeleton skeleton-block" style="height: 80px;"></div></div>
                </div>
            </div>

            <!-- Monitors Visualization -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">üñ•Ô∏è</span> Monitores</div>
                </div>
                <div id="monitors-container"><div class="skeleton skeleton-block" style="height: 150px;"></div></div>
            </div>

            <!-- Quick Links -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">‚ö°</span> Quick Links</div>
                </div>
                <div id="quick-links" class="quick-links"></div>
            </div>
        </section>

        <!-- Tab: Claude Max -->
        <section id="tab-claude" class="tab-content" style="display: none;">
            <div id="claude-stats"><div class="skeleton skeleton-block" style="height: 300px;"></div></div>
        </section>

        <!-- Tab: Storage -->
        <section id="tab-storage" class="tab-content" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">üíæ</span> Storage Analysis (APFS)</div>
                </div>
                <div id="storage-content"><div class="skeleton skeleton-block" style="height: 250px;"></div></div>
            </div>
        </section>

        <!-- Tab: Network -->
        <section id="tab-network" class="tab-content" style="display: none;">
            <div class="card" style="margin-bottom: 1.5rem;">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">üåê</span> Speed Test</div>
                    <button id="run-speedtest" style="background: var(--accent-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">‚ñ∂ Run Test</button>
                </div>
                <div id="speedtest-content">
                    <div class="speedtest-container">
                        <div class="speedtest-metric">
                            <div class="speedtest-value text-orange" id="ping-value">--</div>
                            <div class="speedtest-unit">ms</div>
                            <div class="speedtest-label">Ping</div>
                        </div>
                        <div class="speedtest-metric">
                            <div class="speedtest-value text-green" id="download-value">--</div>
                            <div class="speedtest-unit">Mbps</div>
                            <div class="speedtest-label">Download</div>
                        </div>
                        <div class="speedtest-metric">
                            <div class="speedtest-value text-blue" id="upload-value">--</div>
                            <div class="speedtest-unit">Mbps</div>
                            <div class="speedtest-label">Upload</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab: Dev Tools -->
        <section id="tab-dev" class="tab-content" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span style="margin-right: 0.5rem;">üõ†Ô∏è</span> Development Tools</div>
                </div>
                <div id="devtools-content"><div class="skeleton skeleton-block" style="height: 200px;"></div></div>
            </div>
        </section>

        <!-- Tab: Mac Tips -->
        <section id="tab-tips" class="tab-content" style="display: none;">
            <!-- Tips Header -->
            <div class="card" style="margin-bottom: 1.5rem; background: linear-gradient(135deg, rgba(251, 146, 60, 0.1), rgba(249, 115, 22, 0.1)); border: 1px solid rgba(251, 146, 60, 0.2);">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="font-size: 2.5rem;">‚å®Ô∏è</div>
                    <div>
                        <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 0.25rem;">Mac Tips & Atalhos</h2>
                        <p style="color: var(--text-secondary); font-size: 0.875rem;">Domine seu Mac com <span id="tips-count" style="color: #fb923c; font-weight: 600;">64</span> dicas essenciais organizadas por categoria.</p>
                    </div>
                </div>
            </div>

            <!-- Category Filter -->
            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1.5rem;" id="tips-categories">
                <button class="tips-category active" data-category="all" style="background: rgba(251, 146, 60, 0.2); color: #fb923c; border: none; padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; font-weight: 500; transition: all 0.2s;">üéØ Todos</button>
                <button class="tips-category" data-category="Sistema" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">‚öôÔ∏è Sistema</button>
                <button class="tips-category" data-category="Navega√ß√£o" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üß≠ Navega√ß√£o</button>
                <button class="tips-category" data-category="Finder" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üìÅ Finder</button>
                <button class="tips-category" data-category="Texto" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üìù Texto</button>
                <button class="tips-category" data-category="Screenshot" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üì∏ Screenshot</button>
                <button class="tips-category" data-category="Produtividade" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üöÄ Produtividade</button>
                <button class="tips-category" data-category="Dev" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; border-radius: 9999px; cursor: pointer; font-size: 0.875rem; transition: all 0.2s;">üíª Dev</button>
            </div>

            <!-- Tips Grid -->
            <div id="tips-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                <div class="skeleton skeleton-block" style="height: 400px;"></div>
                <div class="skeleton skeleton-block" style="height: 400px;"></div>
            </div>
        </section>

    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script>
    // NERD SPACE V5.0 - Inline JS

    // Tab Navigation
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.dataset.tab;

            // Update active tab
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            // Show/hide content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = content.id === 'tab-' + tabId ? 'block' : 'none';
            });

            // Load data for tab
            loadTabData(tabId);
        });
    });

    // API Helper
    async function api(endpoint) {
        try {
            const res = await fetch('/api' + endpoint);
            return await res.json();
        } catch (e) {
            console.error('API Error:', endpoint, e);
            return null;
        }
    }

    // Dashboard
    async function loadDashboard() {
        // macOS
        const macos = await api('/macos');
        if (macos) {
            document.getElementById('macos-content').innerHTML = `
                <div style="font-size: 1.5rem; font-weight: 700;">${macos.codename} ${macos.version}</div>
                <div style="color: var(--text-muted); font-size: 0.875rem;">Build ${macos.build}</div>
                <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">Kernel ${macos.kernel}</div>
            `;
        }

        // Hardware
        const hw = await api('/dev-tools');
        if (hw) {
            document.getElementById('hardware-content').innerHTML = `
                <div style="font-size: 1.25rem; font-weight: 600;">Apple M3 Max</div>
                <div style="color: var(--text-muted); font-size: 0.875rem;">36 GB RAM</div>
                <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">Python ${hw.python} ‚Ä¢ Node ${hw.node}</div>
            `;
        }

        // Uptime
        const uptime = await api('/uptime');
        if (uptime) {
            document.getElementById('uptime-content').innerHTML = `
                <div style="font-size: 2rem; font-weight: 700; color: var(--accent-green);">${uptime.uptime_formatted}</div>
                <div style="color: var(--text-muted); font-size: 0.875rem;">desde ${uptime.boot_formatted}</div>
            `;
        }

        // Monitors
        const monitors = await api('/monitors');
        if (monitors && monitors.length) {
            const maxWidth = Math.max(...monitors.map(m => m.resolution.width));
            const scale = 180 / maxWidth;

            document.getElementById('monitors-container').innerHTML = `
                <div class="monitors-container">
                    ${monitors.map(m => {
                        const w = m.resolution.width * scale;
                        const h = m.resolution.height * scale;
                        return `
                            <div class="monitor ${m.is_main ? 'main' : ''}" style="width: ${w}px;">
                                ${m.is_main ? '<span class="monitor-badge">‚òÖ</span>' : ''}
                                <div class="monitor-screen" style="width: ${w-12}px; height: ${h-12}px; font-size: 0.625rem;">
                                    ${m.resolution.width}x${m.resolution.height}
                                </div>
                                <div class="monitor-stand"></div>
                                <div class="monitor-label">${m.name.split(' ')[0]}<br><span style="color: var(--text-muted);">${m.refresh_rate}Hz</span></div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // Quick Links
        const links = await api('/quick-links');
        if (links) {
            document.getElementById('quick-links').innerHTML = links.map(l => `
                <div class="quick-link" onclick="alert('Abrindo ${l.name}...')">
                    <div class="quick-link-icon" style="background: var(--bg-hover);">${l.icon === 'terminal' ? 'üíª' : l.icon === 'code' ? 'üìù' : l.icon === 'github' ? 'üêô' : l.icon === 'bot' ? 'ü§ñ' : 'üì±'}</div>
                    <div class="quick-link-name">${l.name}</div>
                    <div class="quick-link-shortcut">${l.shortcut}</div>
                </div>
            `).join('');
        }
    }

    // Claude Max 20x
    async function loadClaude() {
        const data = await api('/claude-usage');
        if (data) {
            const pct5h = data.usage.window_5h.percent;
            const statusClass = pct5h < 50 ? 'healthy' : pct5h < 80 ? 'moderate' : pct5h < 95 ? 'high' : 'critical';

            document.getElementById('claude-stats').innerHTML = `
                <div class="claude-module">
                    <div class="claude-header">
                        <div class="claude-logo">ü§ñ</div>
                        <div>
                            <div class="claude-title">${data.plan.name}</div>
                            <div class="claude-subtitle">$${data.plan.price_usd}/m√™s = R$ ${data.plan.price_brl.toLocaleString('pt-BR')}/m√™s</div>
                        </div>
                    </div>

                    <div class="claude-stats">
                        <div class="claude-stat">
                            <div class="claude-stat-label">Janela 5h</div>
                            <div class="claude-stat-value">${data.usage.window_5h.messages}</div>
                            <div class="claude-stat-sub">de ${data.usage.window_5h.limit} msgs</div>
                            <div class="progress-bar">
                                <div class="progress-fill ${statusClass}" style="width: ${Math.min(pct5h, 100)}%"></div>
                            </div>
                            <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">Reset: ${data.usage.window_5h.next_reset_formatted}</div>
                        </div>

                        <div class="claude-stat">
                            <div class="claude-stat-label">Janela 7d</div>
                            <div class="claude-stat-value">${data.usage.window_7d.messages.toLocaleString()}</div>
                            <div class="claude-stat-sub">de ${(data.usage.window_7d.limit / 1000).toFixed(0)}K msgs</div>
                            <div class="progress-bar">
                                <div class="progress-fill healthy" style="width: ${Math.min(data.usage.window_7d.percent, 100)}%"></div>
                            </div>
                        </div>
                    </div>

                    ${data.tips && data.tips.length > 0 ? `
                        <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(0,0,0,0.2); border-radius: 0.5rem;">
                            <div style="font-size: 0.75rem; font-weight: 500; color: #f59e0b;">üí° Dica</div>
                            <div style="font-size: 0.875rem; color: var(--text-secondary);">${data.tips[0].message}</div>
                        </div>
                    ` : ''}
                </div>
            `;
        }
    }

    // Storage
    async function loadStorage() {
        const data = await api('/storage/v2');
        if (data) {
            const pct = data.percent_used;
            const statusClass = pct < 70 ? 'healthy' : pct < 85 ? 'moderate' : pct < 95 ? 'high' : 'critical';

            document.getElementById('storage-content').innerHTML = `
                <div style="display: flex; align-items: center; gap: 2rem; margin-bottom: 1.5rem;">
                    <div style="flex: 1;">
                        <div style="font-size: 2.5rem; font-weight: 700;">${data.formatted.used}</div>
                        <div style="color: var(--text-muted);">de ${data.formatted.total} usado</div>
                        <div class="progress-bar" style="height: 0.75rem; margin-top: 0.5rem;">
                            <div class="progress-fill ${statusClass}" style="width: ${pct}%"></div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.5rem; font-weight: 600; color: var(--accent-green);">${data.formatted.free}</div>
                        <div style="color: var(--text-muted);">livre</div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">üì± Apps</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.apps.toFixed(1)} GB</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">üíª Developer</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.developer.toFixed(1)} GB</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">‚òÅÔ∏è iCloud</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.icloud.toFixed(1)} GB</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">üì∑ Photos</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.photos.toFixed(1)} GB</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">üóÇÔ∏è Other</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.other.toFixed(1)} GB</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem;">
                        <div style="font-size: 0.75rem; color: var(--text-muted);">‚öôÔ∏è Sistema</div>
                        <div style="font-size: 1.25rem; font-weight: 600;">${data.categories.system_data.toFixed(1)} GB</div>
                    </div>
                </div>
            `;
        }
    }

    // Network / Speed Test
    async function loadNetwork() {
        const data = await api('/speedtest/last');
        if (data && data.latency_ms) {
            document.getElementById('ping-value').textContent = data.latency_ms;
            document.getElementById('download-value').textContent = data.download_mbps;
            document.getElementById('upload-value').textContent = data.upload_mbps;
        }
    }

    document.getElementById('run-speedtest').addEventListener('click', async () => {
        const btn = document.getElementById('run-speedtest');
        btn.disabled = true;
        btn.innerHTML = '‚è≥ Testing...';

        try {
            const res = await fetch('/api/speedtest', { method: 'POST' });
            const data = await res.json();
            if (data.latency_ms) {
                document.getElementById('ping-value').textContent = data.latency_ms;
                document.getElementById('download-value').textContent = data.download_mbps;
                document.getElementById('upload-value').textContent = data.upload_mbps;
            }
        } catch (e) {
            console.error('Speed test error:', e);
        } finally {
            btn.disabled = false;
            btn.innerHTML = '‚ñ∂ Run Test';
        }
    });

    // Dev Tools
    async function loadDevTools() {
        const data = await api('/dev-tools');
        if (data) {
            document.getElementById('devtools-content').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üêç</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Python</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.python}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üì¶</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Node.js</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.node}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üç∫</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Homebrew</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.homebrew}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üêô</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Git</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.git}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üê≥</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Docker</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.docker || 'N/A'}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üíª</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Shell</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.shell} ${data.shell_version}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">üì¶</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">NPM</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.npm}</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 0.5rem; text-align: center;">
                        <div style="font-size: 2rem;">ü§ñ</div>
                        <div style="font-size: 0.875rem; font-weight: 600;">Claude Code</div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">${data.claude_code}</div>
                    </div>
                </div>
                <div style="margin-top: 1rem; padding: 0.75rem; background: var(--bg-secondary); border-radius: 0.5rem; text-align: center;">
                    <span style="color: var(--text-muted);">üç∫ Homebrew Packages:</span>
                    <span style="font-weight: 600; margin-left: 0.5rem;">${data.homebrew_packages}</span>
                </div>
            `;
        }
    }

    // NERD SPACE Home
    async function loadNerdSpace() {
        // Uptime
        const uptime = await api('/uptime');
        if (uptime) {
            document.getElementById('home-uptime').textContent = uptime.uptime_formatted;
        }

        // Storage
        const storage = await api('/storage/v2');
        if (storage) {
            document.getElementById('home-storage').textContent = storage.formatted.free;
        }

        // Displays
        const displays = await api('/displays');
        if (displays) {
            document.getElementById('home-displays').textContent = displays.length;
        }

        // Claude
        const claude = await api('/claude-usage');
        if (claude) {
            document.getElementById('home-claude').textContent = claude.usage.window_5h.percent.toFixed(0) + '%';
        }

        // AI Insights
        loadInsights();
    }

    // AI Insights
    async function loadInsights() {
        const data = await api('/insights');
        const container = document.getElementById('ai-insights-container');

        if (data && data.insights && data.insights.length > 0) {
            container.innerHTML = `
                <div style="display: grid; gap: 0.75rem;">
                    ${data.insights.slice(0, 3).map(insight => `
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.75rem; background: var(--bg-secondary); border-radius: 0.5rem; border-left: 3px solid ${insight.severity === 'warning' ? '#f59e0b' : insight.severity === 'success' ? '#22c55e' : '#3b82f6'};">
                            <span style="font-size: 1.25rem;">${insight.icon || (insight.severity === 'warning' ? '‚ö†Ô∏è' : insight.severity === 'success' ? '‚úÖ' : 'üí°')}</span>
                            <div>
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">${insight.title}</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">${insight.description}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        } else {
            container.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">üß†</div>
                    <div>Nenhum insight dispon√≠vel no momento</div>
                </div>
            `;
        }
    }

    document.getElementById('refresh-insights').addEventListener('click', loadInsights);

    // Mac Tips
    let allTips = [];
    let currentCategory = 'all';

    async function loadTips() {
        const data = await api('/tips');
        if (data && data.tips) {
            allTips = data.tips;
            document.getElementById('tips-count').textContent = allTips.length;
            renderTips();
        }
    }

    function renderTips() {
        const grid = document.getElementById('tips-grid');
        const filtered = currentCategory === 'all'
            ? allTips
            : allTips.filter(t => t.category === currentCategory);

        grid.innerHTML = filtered.map(tip => `
            <div class="card tip-card" style="padding: 1rem; cursor: default; transition: all 0.2s; border: 1px solid var(--border-subtle);">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                    <span style="font-size: 1.5rem;">${getCategoryIcon(tip.category)}</span>
                    <span style="background: rgba(251, 146, 60, 0.15); color: #fb923c; padding: 0.125rem 0.5rem; border-radius: 9999px; font-size: 0.7rem; text-transform: uppercase;">${tip.category}</span>
                </div>
                <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem;">${tip.title}</h3>
                <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.75rem;">${tip.description}</p>
                <div style="background: var(--bg-tertiary); padding: 0.5rem 0.75rem; border-radius: 0.375rem; font-family: monospace; font-size: 0.875rem; color: var(--accent-green);">
                    ${tip.shortcut || tip.command || '‚Äî'}
                </div>
            </div>
        `).join('');
    }

    function getCategoryIcon(category) {
        const icons = {
            'Navega√ß√£o': 'üß≠',
            'Finder': 'üìÅ',
            'Texto': 'üìù',
            'Screenshot': 'üì∏',
            'Sistema': '‚öôÔ∏è',
            'Produtividade': 'üöÄ',
            'Dev': 'üíª',
            'Terminal': 'üíª'
        };
        return icons[category] || 'üí°';
    }

    // Category filter
    document.querySelectorAll('.tips-category').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.tips-category').forEach(b => {
                b.style.background = 'var(--bg-secondary)';
                b.style.color = 'var(--text-secondary)';
                b.style.border = '1px solid var(--border-subtle)';
                b.classList.remove('active');
            });
            btn.style.background = 'rgba(251, 146, 60, 0.2)';
            btn.style.color = '#fb923c';
            btn.style.border = 'none';
            btn.classList.add('active');
            currentCategory = btn.dataset.category;
            renderTips();
        });
    });

    // Header Clock
    function updateClock() {
        const now = new Date();
        const timeStr = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
        document.getElementById('header-clock').textContent = timeStr;
    }
    updateClock();
    setInterval(updateClock, 60000);

    // Header Speed Test
    async function updateHeaderSpeed() {
        const data = await api('/speedtest/last');
        if (data && data.download_mbps) {
            document.getElementById('header-speed-value').textContent = data.download_mbps + ' Mbps';
        }
    }
    updateHeaderSpeed();

    document.getElementById('header-speedtest').addEventListener('click', async () => {
        const btn = document.getElementById('header-speedtest');
        const valueEl = document.getElementById('header-speed-value');
        btn.disabled = true;
        valueEl.textContent = '...';
        valueEl.style.color = 'var(--text-muted)';

        try {
            const res = await fetch('/api/speedtest', { method: 'POST' });
            const data = await res.json();
            if (data.download_mbps) {
                valueEl.textContent = data.download_mbps + ' Mbps';
                valueEl.style.color = 'var(--accent-green)';
            }
        } catch (e) {
            valueEl.textContent = 'Erro';
            valueEl.style.color = '#ef4444';
        } finally {
            btn.disabled = false;
        }
    });

    // Header Trash
    async function updateHeaderTrash() {
        const data = await api('/trash');
        if (data) {
            document.getElementById('header-trash-count').textContent = data.total_items || 0;
        }
    }
    updateHeaderTrash();

    document.getElementById('header-trash').addEventListener('click', async () => {
        const data = await api('/trash');
        if (data && data.total_items > 0) {
            if (confirm(`Esvaziar lixeira? (${data.total_items} itens, ${data.total_size_human})`)) {
                await fetch('/api/trash/empty', { method: 'POST' });
                updateHeaderTrash();
            }
        } else {
            alert('Lixeira vazia!');
        }
    });

    // Action buttons
    document.getElementById('action-speedtest')?.addEventListener('click', () => {
        document.getElementById('header-speedtest').click();
    });

    document.getElementById('action-trash')?.addEventListener('click', () => {
        document.getElementById('header-trash').click();
    });

    // Update loadTabData to include new tabs
    async function loadTabData(tabId) {
        switch(tabId) {
            case 'nerdspace': loadNerdSpace(); break;
            case 'dashboard': loadDashboard(); break;
            case 'claude': loadClaude(); break;
            case 'storage': loadStorage(); break;
            case 'network': loadNetwork(); break;
            case 'dev': loadDevTools(); break;
            case 'tips': loadTips(); break;
        }
    }

    // Initial load - Start on NERD SPACE home
    loadNerdSpace();
    </script>
</body>
</html>
